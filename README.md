# ExampleJavaAngular

Here is how to create an interaction between Java and Angular to get started with a simple example with an explanation.

## Initialization and structuring of the repository:

Structure your repository with separate folders for the front-end and back-end:
```
ExampleJavaAngular/
├── backend/
│   └── (Java REST API code)
└── frontend/
    └── (Angular code)
```

If starting from scratch, create a new repository:

```
git init ExampleJavaAngular
git add .
git commit -m "Initial commit"
```

'backend' and 'frontend' folders can be created when the corresponding projects are created, so you don't need to create them right away.

If necessary, connect the new repository to the remote repository.

## Java Backend

### Create new Spring project

Create a new Spring project using https://start.spring.io/

For a simple example, we only need Spring Web.

![image](https://github.com/user-attachments/assets/82fcd893-d38f-4369-99a5-817775a85920)

Extract the project to the 'ExampleJavaAngular'-'backend' directory.

![image](https://github.com/user-attachments/assets/806f56d3-dfdb-493c-8924-2ee874151136)

Open the project in the IDE.

### CORS Configuration

<details>
   <summary>About CORS (generated by ChatGPT)</summary>
   <p>
  
CORS (Cross-Origin Resource Sharing) is a security feature implemented by web browsers to allow or restrict web pages from making requests to a different domain than the one that served the web page. This is essential for web security as it prevents malicious websites from accessing sensitive data on another domain without the user's consent.

How CORS Works
When a web page makes a cross-origin request, the browser sends an HTTP request with an Origin header indicating the source of the request. The server can then respond with certain headers to indicate whether the request should be allowed or not. The key headers involved in CORS are:

<li> Access-Control-Allow-Origin: Specifies which origins are allowed to access the resource. A wildcard * can be used to allow all origins, but this is not recommended for sensitive data.
<li> Access-Control-Allow-Methods: Lists the HTTP methods (e.g., GET, POST, PUT) that the server allows for cross-origin requests.
<li> Access-Control-Allow-Headers: Specifies which headers can be used in the actual request.
<li> Access-Control-Allow-Credentials: Indicates whether credentials (cookies, authorization headers, or TLS client certificates) can be used in the request.
<li> Access-Control-Expose-Headers: Specifies which headers can be exposed to the web page.
<li> Access-Control-Max-Age: Indicates how long the results of a preflight request can be cached.
  
Preflight Requests

For certain types of requests (e.g., those that use methods other than GET or POST, or those that use custom headers), the browser sends a preflight request using the OPTIONS method to determine whether the actual request is safe to send. This preflight request checks with the server whether the cross-origin request is allowed by sending the Origin header and the intended HTTP method and headers.

Example

If you have a web page hosted on example.com that wants to make a request to api.example.com, the request might look like this:

Request from the web page:

```
GET /data HTTP/1.1
Host: api.example.com
Origin: http://example.com
```

Response from the server:
```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: http://example.com
Content-Type: application/json
```

If the Access-Control-Allow-Origin header in the response matches the Origin header in the request, the browser allows the request to proceed. Otherwise, the browser blocks the request.

Handling CORS in Development

When developing web applications, you may encounter CORS issues if your front-end and back-end are hosted on different domains. To handle this, you can configure your server to include the appropriate CORS headers or use tools like proxies during development to bypass CORS restrictions.

To handle CORS with a Java Spring back-end and an Angular front-end, you'll need to configure CORS settings in your Spring application and make sure your Angular application is making requests in a way that adheres to those settings. Here's a step-by-step guide for both:

1. Configuring CORS in Spring Boot
In your Spring Boot application, you can configure CORS globally or on a per-controller basis.

Global CORS Configuration
You can create a configuration class to define global CORS settings:

```
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class WebConfig implements WebMvcConfigurer {

    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**")
                .allowedOrigins("http://localhost:4200") // Angular app's URL
                .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
                .allowedHeaders("*")
                .allowCredentials(true);
    }
}
```

This configuration allows requests from http://localhost:4200 (the default URL for Angular's development server), and permits all HTTP methods and headers.

Per-Controller CORS Configuration

Alternatively, you can configure CORS on a specific controller or method using the @CrossOrigin annotation:

```
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping("/api")
@CrossOrigin(origins = "http://localhost:4200")
public class MyController {

    @GetMapping("/data")
    public String getData() {
        return "Hello from Spring Boot!";
    }
}
```

2. Handling CORS in Angular
3. In your Angular application, you don't need to configure CORS explicitly. Just make sure you make HTTP requests to the correct back-end URL and handle any preflight requests properly.

Use Angular's HttpClient to make requests:

```
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root'
})
export class ApiService {

  private apiUrl = 'http://localhost:8080/api'; // Spring Boot app's URL

  constructor(private http: HttpClient) { }

  getData() {
    return this.http.get(`${this.apiUrl}/data`);
  }
}
```
</p>
</details>

Add a CorsConfiguration bean to ensure your Java REST API allows CORS (Cross-Origin Resource Sharing) requests from your Angular application.

```
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class WebConfig {

    @Bean
    public WebMvcConfigurer corsConfigurer() {
        return new WebMvcConfigurer() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/**").allowedOrigins("http://localhost:4200");
            }
        };
    }
}
```

### Create a REST Controller:

Create a REST controller in your Java Spring Boot application to handle HTTP requests and provide data. Let's also add a get method to display some data.

```
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.HashMap;
import java.util.Map;

@RestController
public class ApiController {

    @GetMapping("/api/data")
    public Map<String, String> getData() {
        Map<String, String> data = new HashMap<>();
        data.put("message", "Hello from the Java API!");
        return data;
    }

}
```

### Run Your Spring Boot Application:

Run your Spring Boot application to start the server.

![image](https://github.com/user-attachments/assets/42169d6a-5a99-4d39-8107-1bdad56cc712)

You can view your json-data at http://localhost:8080/api/data

![image](https://github.com/user-attachments/assets/93848281-a8ef-4e7a-9701-346c1bdc965c)


## Angular Front-End

### Set Up Your Development Environment

Install Node.js and npm (Node Package Manager).

Install Angular CLI globally using npm:

```
npm install -g @angular/cli
```

### Create a new Angular project

You can use VSCode as an IDE for example.
Open the ExampleJavaAngular folder in the IDE.

![image](https://github.com/user-attachments/assets/99af876a-cd14-4ff9-b4d4-a58a54fd9881)

Open terminal ctrl+~.

Create new project by commands:

```
ng new frontend
```

![image](https://github.com/user-attachments/assets/62798773-0b8f-4089-942e-7e95411b84bb)

![image](https://github.com/user-attachments/assets/f641a73b-b8a3-43a3-8742-394455371dac)

Go to the project:

```
cd frontend
```

![image](https://github.com/user-attachments/assets/14d2669a-97c7-4170-a26b-373de27dd630)

Use Angular CLI to generate components, services, and other necessary parts of your application:

https://v17.angular.io/cli/generate

### Service for HTTP Requests:

Create a service that will handle HTTP requests to your Java REST API. For example, api.service.ts:

```
ng generate service api
```

The service must contain the following code (for now we start with just a get request):

```
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class ApiService {
  private apiUrl = 'http://localhost:8080/api';

  constructor(private http: HttpClient) { }

  getData(): Observable<any> {
    return this.http.get(`${this.apiUrl}/data`);
  }

}
```

Don't forget to save changes ctrl+S!

### Create Your Angular Components

```
ng generate component my --standalone
```

'standalone' - whether the generated component is standalone.

The 'frontend\src\app\my\my.component.ts' must contain the following code:

```
import { Component, OnInit  } from '@angular/core';
import { CommonModule } from '@angular/common';
import { HttpClientModule } from '@angular/common/http'; 
import { ApiService } from '../api.service';

@Component({
  selector: 'app-my-comp',
  standalone: true,
  imports: [CommonModule, HttpClientModule],
  templateUrl: './my.component.html',
  styleUrl: './my.component.css'
})
export class MyCompComponent implements OnInit {
  data: any;

  constructor(private apiService: ApiService) { }

  ngOnInit(): void {
    this.apiService.getData().subscribe(
      response => {
      console.log('Data fetched successfully:', response);
      this.data = response;
    },
    error => {
      console.error('Error fetching data:', error);
    }
  );
  }

}
```

The 'frontend\src\app\my\my.component.html' must contain the following code:

```
<div>
    <h1>Data from API</h1>
    <pre>{{ data | json }}</pre>
</div>
```

The 'frontend\src\app\app.component.ts' must contain the following code:

```
import { Component } from '@angular/core';
import { RouterOutlet } from '@angular/router';
import { HttpClientModule } from '@angular/common/http'; 
import { MyComponent } from './my/my.component';

@Component({
  selector: 'app-root',
  standalone: true,
  imports: [RouterOutlet, HttpClientModule, MyComponent],
  templateUrl: './app.component.html',
  styleUrl: './app.component.css'
})
export class AppComponent {
  title = 'ExampleJavaAngular';
}
```

The 'frontend\src\app\app.component.html' must contain the following code:

```
<div>
  <h1>{{ title }}</h1>
  <app-my-comp></app-my-comp>
</div>
```

The 'frontend\src\app\app.config.ts' must contain the following code:

```
import { ApplicationConfig } from '@angular/core';
import { provideHttpClient } from '@angular/common/http';

export const appConfig: ApplicationConfig = {
  providers: [
    provideHttpClient()
  ]
};
```

The 'frontend\src\main.ts' must contain the following code:

```
import { bootstrapApplication } from '@angular/platform-browser';
import { appConfig } from './app/app.config';
import { AppComponent } from './app/app.component';

bootstrapApplication(AppComponent, appConfig)
  .catch((err) => console.error(err));
```

To start the server:
```
ng serve
```

To exit:  ctrl+C

http://localhost:4200/

![image](https://github.com/user-attachments/assets/0bcd68c5-4c20-4500-b0ca-e5fa79d1330b)
